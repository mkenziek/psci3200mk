---
title: "Final Project Research Design"
author: "Makenzie Kerneckel"

institute: "University of Pennsylvania"
date: last-modified
toc: true

bibliography: references.bib

format: 
  html:
    self-contained: true

editor: source
---

# I. Introduction

Turf wars for the control of drug trafficking corridors in Mexico have been associated with a lethal crisis of criminal violence in the country since the 1990s. After peaceful coexistence in the 1980s, six turf wars broke out between Mexico’s five major cartels (Tijuana, Juárez, Sinaloa, Gulf, and La Familia Michoacana) on the Pacific Coast between 1990 and 2006 [@trejo2018did]. Annual turf war deaths reached 1,400 in 2006 [@trejo2018did]. In 2006, the Felipe Calderón administration (2006-2012) began the first large-scale deployment of federal troops against the drug cartels, marking the beginning of the “Mexican War on Drugs” [@espinosa2015did]. To implement large-scale efforts to combat drug trafficking, the Calderón administration worked with PAN mayors and municipal police. The crackdowns on drug cartels under Calderón ushered in a dramatic spiral of violence [@trejo2018did]. Between 2007 and 2012, more than 70,000 people were murdered in intercartel conflicts [@trejo2018did]. For political context, Calderón was Mexico’s second National Action Party (PAN) president, continuing PAN’s control of the office after Vicente Fox’s electoral victory for PAN in 2000. Fox’s election as president represented the first opposition candidate to win the presidency of Mexico in recent history, ending the Institutional Revolutionary Party’s (PRI) hegemonic, 71-year-long rule [@trejo2018did]. The Institutional Revolutionary Party (PRI) has historically represented a center-right platform with a broad base of support, while the National Action Party (PAN) emerged as a conservative opposition advocating for free-market economics and social conservatism [@cfr2024]. Subsequently, President Enrique Peña Nieto (PRI) initiated reform efforts in 2012, which, although initially yielding decreases in homicides, ultimately fell short in tackling deep-rooted corruption and crime-related violence, culminating in a peak of 33,341 homicides in 2018 [@cfr2024]. In response to widespread criticism of militarized approaches, President Andrés Manuel López Obrador a left-wing candidate of the Morena party, upon assuming office in 2018, vowed to shift towards civilian-led policing; however, despite the implementation of initiatives like the creation of a new National Guard, violence levels have persistently remained high, amplifying the challenges in governance, security, and anti-corruption endeavors [@cfr2024].

This study delves into the relationship between the success of PAN candidates in Mexican municipal elections and fluctuations in the post-election municipal homicide rate per 100,000 people, while considering the impact of party rotation in mayoral office and the stability of PAN mayoral governance. Inspired by the work of Trejo and Ley (2018), this research challenges the traditional understanding of a clear separation between government authorities and organized crime groups (OCGs), aiming to explore the 'gray zone' where these entities intersect through informal protection systems (Trejo & Ley, 2018). Understanding how party alternation may disrupt state-criminal arrangements is essential for comprehending the broader dynamics of violence and governance in Mexico. Independent variables include the margin of victory for the PAN candidate, a municipal alternation index measuring party rotation, and a PAN power index assessing the stability of PAN mayoral terms. The dependent variable is the post-election municipal homicide rate per 100,000 people, encompassing all homicides, not solely those associated with inter-cartel conflicts.

Scholars have focused on identifying why intercartel violence in Mexico broke out in the early 2000s and estimating the causal effects of military interventions under Calderón on homicide rates in Mexico. According to [@trejo2018did], the rotation of political parties in state gubernatorial power in Mexico between 1991 and 2006 significantly contributed to the outbreak of intercartel violence and large-scale criminal wars. Their paper focused on analyzing the period from 1991 to 2006, prior to Calderón’s federal intervention. Trejo and Ley highlight the role of top- and mid-level officials’ removal from key state-level institutions, such as the state attorney’s office and the state judicial police, in disrupting informal protections for drug cartels previously provided under the one-party rule of the PRI. From its founding in 1929 to 1988, PRI had won every gubernatorial election in Mexico’s 31 states and nearly all municipal races. The study’s key finding reveals a 55.3% increase in violence in municipalities from states experiencing party alternation at the governor level compared to those under PRI hegemony, indicating a loss of cartel protection. Economic factors and organizational dynamics further strengthened this relationship. Further, time trend analysis suggests a surge in violence during the initial year of opposition governors, reflecting a disruption in government protection networks. Ultimately, Trejo and Ley’s “instability hypothesis” argues that when PRI lost power at the state level an informal network of cartel protection was thrown off leading to an outbreak of inter-cartel violence. Contrary to [@trejo2018did], Dell (2015) concentrates on the surge in violence following the Mexican government’s War on Drugs between 2007 and 2012, attributing the escalation to rival traffickers vying for territories after crackdowns initiated by PAN mayors, which diverted drug traffic and intensified violence along alternative routes. Dell’s “diversion hypothesis” posits that crackdowns in one area (i.e. PAN municipalities) lead to the diversion of drug activity and homicides to other regions without substantial reduction [@dell2015trafficking]. The key finding indicates that close PAN victories at the municipal level led to approximately 33 more drug trade-related homicides per 100,000 people annually during a mayor's three-year term [@dell2015trafficking].

While prior research has provided valuable insights into the drivers of drug-related violence in Mexico, there remains a gap in understanding how political governance factors, particularly related to PAN governance stability and mayoral turnover, influence homicide rates at the municipal level after the war on drugs began in 2006 extending to 2020. There are two specific gaps that this paper seeks to address. First, earlier contributions, like Dell (2015), have focused exclusively on drug-related homicides which are defined as “any instance in which a civilian kills another civilian, with at least one of the parties involved in the drug trade" [@dell2015trafficking]. This paper uses general homicide rates to include deaths beyond the drug-related homicide definition. For example, instances of those killed in armed clashes between police and organized criminals and the deaths of undocumented immigrants who were targeted by drug cartels for profit during the war on drugs. This paper sees overall homicide rates as a better measure of the intensity of violence that emerged following the declaration of the Mexican War on Drugs. Second, while Trejo and Ley (2018) focus on the impact of party alternation in gubernatorial power on violence between cartels, this paper focuses on the impact of party alternation in mayoral power on municipal homicide rates zooming in on a smaller unit of analysis. Lastly, this analysis aims to make an original contribution to the research base by exploring whether the length that the PAN party held a mayoral office impacted municipal homicide rates.

Can you tell us something about the role of mayors, and why we should expect that their alteration matters for the outcomes you care about?

It might be useful to give us a sentence on how a murder is determined to be drug-related or not.

# II. Data

The dataset utilized in this study comprises publicly available data from the National Institute of Statistics and Geography (INEGI), sourced from two GitHub repositories. The first repository aggregates homicide rate data spanning from 2000 to 2021, while the second repository provides election returns data compiled by Eric Magar, a professor of political science at Instituto Tecnológico Autónomo de México, covering the same period of time [@Magar_Recent_Mexican_Election_2018 ; @mexico-homicide-rates]. Municipalities in Mexico serve as the unit of analysis for this research, encompassing the period from 2001 to 2020, with 2021 data omitted due to incomplete election cycles (i.e. the next election is not being held until June 2024). The independent variables selected for analysis include a Municipal Alternation Index, measuring the cumulative alternations in party power within municipalities over time; the PAN Power Index, quantifying the consecutive years of PAN governance at the municipal level; and Vote Margin, reflecting the margin of victory for PAN candidates in mayoral elections. Elections where the margin of victory falls between -0.05 and 0.05 are considered close elections. The dependent variable in this analysis is the Post-election Homicide Rate, denoting the average homicide rate per 100,000 people in the period following a municipal election. It is calculated for each municipality and election cycle, capturing the level of violence observed in the aftermath of local elections.

```{r, message = FALSE, echo=FALSE, warning= FALSE}

# load libraries 

library(foreign)
library(magrittr)
library(rio)
library(ggplot2)
library(kableExtra)
library(dplyr)
library(rdrobust)
library(tidyverse)



# load data 

election_returns <- read.csv("/Users/kenziekmac/Dropbox/Mac/Documents/GitHub/psci3200mk/Data/aymu1970-on.coalSplit.csv")

homicide_rates <- readr::read_delim("/Users/kenziekmac/Dropbox/Mac/Documents/GitHub/psci3200mk/Data/mexico-muni-month-homicide-rates-2000-2021.csv", delim = "|")


# start data cleaning 

# have leading zeros so all municipal level identifiers are 5 digits

#head(unique(homicide_rates$ent_mun))

# does not have leading zeros 

#head(unique(election_returns$inegi))

# let's add leading zeros to the election_returns data 

# Function to add leading zeros

add_leading_zeros <- function(x) {
  ifelse(nchar(x) == 4, paste0("0", x), as.character(x))
}

# Apply the function to the column

election_returns$inegi <- as.numeric(election_returns$inegi)

election_returns$inegi <- sapply(election_returns$inegi, add_leading_zeros) 


election_returns %<>% rename( "ent_mun" = "inegi")
  
# Check for municipal codes present in df1 but not in df2

# these are missing election returns/ newly created municipalities 

records_only_in_df1 <- anti_join(election_returns, homicide_rates, by = "ent_mun")

# drop these municipalities since they don't have corresponding homicide rates 

ent_mun_drops_er <- records_only_in_df1$ent_mun

# 34,634 rows at start 

election_returns %<>% filter(!is.na(ent_mun)) %>%
                      filter(! ent_mun %in% ent_mun_drops_er)

# 34,624 after, dropped 10 rows 


# Check for municipal codes present in df2 but not in df1

# these are missing homicide rates

records_only_in_df2 <- anti_join(homicide_rates, election_returns, by = "ent_mun")

# drop these municipalities since they don't have corresponding election returns 

ent_mun_drops_hr <- records_only_in_df2$ent_mun

# 651,288 rows at start 

homicide_rates %<>% filter(!is.na(ent_mun)) %>%
  filter(! ent_mun %in% ent_mun_drops_hr)

# 650,232 after, dropped 1056 rows

 

# pick rows we need

election_returns %<>% select(-c(1,3,5,8)) 

# break election date into month and year so we can merge on these variables to match monthly homicide rates

election_returns$date<- as.character(election_returns$date)
  
election_returns %<>% mutate( date = as.Date(election_returns$date, format = "%Y%m%d"),
                              year = format(date, "%Y"),
                              month = format(date, "%m"))

# pick rows we need, again

election_returns %<>% select(-c(1,4))

# filter years bc homicide data starts at 2000

election_returns %<>% filter(year >= 2000)

# add leading zeros to homicide month col.


add_leading_zeros_2 <- function(x) {
  ifelse(nchar(x) == 1, paste0("0", x), as.character(x))
}

# Apply the function to the column


homicide_rates$month <- as.numeric(homicide_rates$month)

homicide_rates$month <- sapply(homicide_rates$month, add_leading_zeros_2) 


# v01, v02, … = raw vote for candidate 1, 2, etc.

# l01, l02, … = label of candidate 1's, 2's, … party or coalition.

# i want the data to have a col name pri_vote and show raw vote for pri candidate,
# right now the raw vote and party are seperate columns 

# Fix candidate columns 

election_returns %<>%
  mutate_at(vars(starts_with("l")), ~replace(., . == 0, NA)) %>%
  mutate_at(vars(starts_with("l")), as.character)




         
# For Loop to find the first and second place parties for each election  

# Initialize lists to store results
highest_col <- vector("list", length = nrow(election_returns))
second_highest_col <- vector("list", length = nrow(election_returns))

# Loop through each row
for (i in 1:nrow(election_returns)) {
  # Get the row values excluding non-numeric columns
  row_values <- as.numeric(unlist(election_returns[i, grep("^v", names(election_returns))]))
  
  # Find the index of the highest value
  highest_index <- which.max(row_values)
  
  # Set the highest value to -Inf so it's excluded when finding the second highest
  row_values[highest_index] <- -Inf
  
  # Find the index of the second highest value
  second_highest_index <- which.max(row_values)
  
  # Get the column names corresponding to the highest and second-highest values
  highest_col[[i]] <- names(election_returns)[grep("^v", names(election_returns))][highest_index]
  second_highest_col[[i]] <- names(election_returns)[grep("^v", names(election_returns))][second_highest_index]
}

# Convert lists to character vectors
highest_col <- sapply(highest_col, function(x) ifelse(is.null(x), NA, x))
second_highest_col <- sapply(second_highest_col, function(x) ifelse(is.null(x), NA, x))

# Add the results to the original dataset
election_returns$highest_col <- highest_col
election_returns$second_highest_col <- second_highest_col


# For Loop to Create Raw Votes Columns 

# Initialize a list to store selected columns
selected_columns <- vector("list", length = nrow(election_returns))

# Loop through each row
for (i in 1:nrow(election_returns)) {
  # Get the column names for the current row
  highest_col_name <- election_returns$highest_col[i]
  second_highest_col_name <- election_returns$second_highest_col[i]
  
  # Select columns based on the column names
  first_place_raw_votes <- election_returns[[highest_col_name]][i]
  second_place_raw_votes <- election_returns[[second_highest_col_name]][i]
  
  
  # Combine the selected columns into a data frame
  selected_columns[[i]] <- cbind(first_place_raw_votes, second_place_raw_votes)
}

# Convert the list to a data frame
selected_raw_votes_df <- as.data.frame(do.call(rbind, selected_columns)) %>%
                       cbind(election_returns[,c(1,2,55,59,58)]) %>%
                       select(3,4,1,2,5,6,7)


# For loop to create party columns 

# Initialize a list to store selected columns
selected_columns <- vector("list", length = nrow(election_returns))

# Loop through each row
for (i in 1:nrow(election_returns)) {
  # Get the party names for the current row
  highest_col_party <- paste0("l", substr(election_returns[i, "highest_col"], 2, 3))
  second_highest_col_party <- paste0("l", substr(election_returns[i, "second_highest_col"], 2, 3))
  
  # Select columns based on the party names
  first_place_party <- election_returns[i, highest_col_party]
  second_place_party <- election_returns[i, second_highest_col_party]
  
  # Combine the selected columns into a data frame
  selected_columns[[i]] <- cbind(first_place_party, second_place_party)
}

# Convert the list to a data frame
selected_parties_df <- as.data.frame(do.call(rbind, selected_columns))


election_returns_cleaned <- cbind(selected_raw_votes_df, selected_parties_df)


```

```{r, warning = FALSE, echo=FALSE}

# Create Independent Variables 


# Independent Var. #1: municipal alternation index variable 

# convert year column to numeric 

election_returns_cleaned$year <- as.numeric(election_returns_cleaned$year)


# Function to count cumulative alternations in party power for each municipality and year
count_alternations <- function(data) {
  # Check if there's only one party or no data
  if (nrow(unique(data[, c("year", "first_place_party")])) <= 1) {
    return(rep(0, nrow(data)))
  }
  
  # Initialize alternation score
  alternation_score <- numeric(nrow(data))
  
  # Compute cumulative alternation score
  for (i in 2:nrow(data)) {
    if (!is.na(data$first_place_party[i]) && !is.na(data$first_place_party[i - 1]) &&
        data$first_place_party[i] != data$first_place_party[i - 1]) {
      alternation_score[i] <- alternation_score[i - 1] + 1
    } else {
      alternation_score[i] <- alternation_score[i - 1]
    }
  }
  
  return(alternation_score)
}

# Calculate cumulative alternation index for each municipality and year
election_returns_cleaned <- election_returns_cleaned %>%
  group_by(ent_mun) %>%
  mutate(alternation_index = count_alternations(cur_data())) %>%
  ungroup()

# Independent Var. #2: PAN power index

# Function to count consecutive years in power for the pan party for each municipality
count_years_in_power <- function(data) {
  # Initialize years in power count
  years_in_power <- rep(0, nrow(data))
  
  # Compute consecutive years in power for the pan party
  for (i in 1:nrow(data)) {
    if (!is.na(data$first_place_party[i]) && data$first_place_party[i] == "pan") {
      years_in_power[i] <- ifelse(i == 1, 1, years_in_power[i - 1] + 1)
    }
  }
  
  return(years_in_power)
}

# Calculate years in power index for the pan party for each municipality

election_returns_cleaned <- election_returns_cleaned %>%
  group_by(ent_mun) %>%
  mutate(pan_consec_yrs_in_pwr = count_years_in_power(cur_data())) %>%
  ungroup()


# # Dependent Variable Creation: Post-election homicide rates 
# 
# # This part of the code creates a function named calculate_post_election_avg. This function
# # calculates the average homicide rate for a municipality in the period after an election and # before the next election (usally a 3 year period).
# 
# 
# # join elections and homicide data 
# 
# elections_hom <- full_join(homicide_rates,election_returns_cleaned, by = c("ent_mun", "month", "year")) %>%
#                   filter( year >= 2001)
# 
# 
# # Convert 'year' and 'month' to a Date object
# 
# elections_hom$date <- as.Date(paste(elections_hom$year, elections_hom$month, "01", sep = "-"))
# 
# # create election year binary variable 
# 
# elections_hom <- elections_hom %>%
#   filter(date >= as.Date("2001-08-01")) %>%
#   mutate( election_year = ifelse(is.na(pan_consec_yrs_in_pwr), 0, 1)) 
# 
# 
# 
# # Define a function to calculate post-election average homicide rate
# calculate_post_election_avg <- function(data, election_date, next_election_date, municipality) {
#   post_election_data <- data %>%
#     filter(ent_mun == municipality) %>%
#     filter(date < as.Date(next_election_date)) %>%
#     filter(date != as.Date(election_date))
#   post_election_avg_rate <- mean(post_election_data$homicide_rate, na.rm = TRUE)
#   return(post_election_avg_rate)
# }
# 
# # Initialize homicide rates 
# 
# post_election_avg_rates <- numeric(nrow(elections_hom))
# 
# 
# for (i in 1:nrow(elections_hom)) {
#   if (elections_hom$election_year[i] == 1) {
#     election_date <- elections_hom$date[i]
#     mun <- elections_hom$ent_mun[i]
#     
#     # Find the index of the next row where election_year == 1
#     next_election_index <- which(elections_hom$election_year[(i+1):nrow(elections_hom)] == 1)[1] + i
#     
#     # Check if there's a next election date
#     if (!is.na(next_election_index)) {
#       next_election_date <- elections_hom$date[next_election_index]
#       
#       # Calculate post-election average rates
#       post_election_avg_rates[i] <- calculate_post_election_avg(elections_hom, election_date, next_election_date, mun)
#     }
#   }
# }
# 
# 
# # Add the calculated post-election average homicide rates as a new column in the dataset
# 
# elections_hom$post_election_avg_rate <- post_election_avg_rates
# 
# # filter out 2021 since that was the most recent election year
# 
# # filter to only election years with post-election homicide rates 
# 
# elections_hom  %<>% filter( election_year == 1, 
#                             year < 2021)

# Writing data to a CSV file
# write.csv(elections_hom, "/Users/kenziekmac/Dropbox/Mac/Documents/GitHub/psci3200mk/Data/post_election_homicide_clean.csv")

# short cut to load cleaned file 

elections_hom <- read.csv("/Users/kenziekmac/Dropbox/Mac/Documents/GitHub/psci3200mk/Data/post_election_homicide_clean.csv")

# Potential Covariate: add variable that shows which presidency the election occurs during 

# Vicente Fox (2000-2006): National Action Party (PAN) to be elected in more than 70 years, ending the long-standing rule of the Institutional Revolutionary Party (PRI).

# Felipe Calderón (2006-2012): National Action Party (PAN), succeeded Vicente Fox as president.

# Enrique Peña Nieto (2012-2018): Institutional Revolutionary Party (PRI)

# Andrés Manuel López Obrador (2018-Present): National Regeneration Movement (MORENA), marking the first time a leftist candidate has been elected president in Mexico's modern history.

# presidential elections occurs in june in mexico

elections_hom %<>%
  mutate( president = ifelse(date < as.Date("2006-06-01"), "Fox (2000-2006, PAN)",
                      ifelse(( date > as.Date("2006-06-01") & 
                      date < as.Date("2012-06-01")), "Calderón (2006-2012, PAN)",
                      ifelse(( date > as.Date("2012-06-01") & 
                      date < as.Date("2018-06-01")), "Nieto (2012-2018, PRI)",
                                           "Obrador (2018-Present, MORENA)"))))


# Independent Var. #3: Victory of the PAN (National Action Party) candidate variable 


# Filter rows where the first-place party is "pri" and the second-place party is "pan",
# rename columns for clarity, and remove unnecessary columns

pri_winners <- elections_hom %>%
  filter(first_place_party == "pri") %>%
  filter(second_place_party == "pan") %>%
  rename( "pri_raw_votes" = "first_place_raw_votes",
          "pan_raw_votes" = "second_place_raw_votes") %>%
  select(-c(first_place_party, second_place_party))



# Filter rows where the first-place party is "pan" and the second-place party is "pri",
# rename columns for clarity, and remove unnecessary columns

pan_winners <- elections_hom %>%
  filter(first_place_party == "pan") %>%
  filter(second_place_party == "pri") %>%
  rename( "pan_raw_votes" = "first_place_raw_votes",
          "pri_raw_votes" = "second_place_raw_votes") %>%
  select(-c(first_place_party, second_place_party))

# Combine datasets of PRI and PAN winners, calculate vote shares, margin of victory,
# and filter for close elections (margin of victory within -0.05 and 0.05)
# inspired by Dell 2015

pan_pri_close_elections <- rbind(pri_winners, pan_winners) %>%
  mutate( pri_vote_share = pri_raw_votes/efec,
          pan_vote_share = pan_raw_votes/efec)


# create rd variables 


pan_pri_close_elections$pan_won <- NA

pan_pri_close_elections$pan_won[pan_pri_close_elections$pan_vote_share > 0.5] <- 1

pan_pri_close_elections$pan_won[pan_pri_close_elections$pan_vote_share < 0.5] <- 0

pan_pri_close_elections$votemargin <- pan_pri_close_elections$pan_vote_share - .5

pan_pri_close_elections$f_x_win <- pan_pri_close_elections$votemargin * pan_pri_close_elections$pan_won

```

```{r, echo=FALSE}


# Calculate mean and range for key variables
summary_stats <- elections_hom %>%
                  summarise(mean_alternation = mean(alternation_index, na.rm = TRUE),
                           range_alternation = paste0(round(min(alternation_index, na.rm = TRUE), 3), "-", round(max(alternation_index, na.rm = TRUE), 3)),
            mean_pan_power = mean(pan_consec_yrs_in_pwr, na.rm = TRUE),
            range_pan_power = paste0(round(min(pan_consec_yrs_in_pwr, na.rm = TRUE), 3), "-", round(max(pan_consec_yrs_in_pwr, na.rm = TRUE), 3)),
            mean_homicide_rate = mean(post_election_avg_rate, na.rm = TRUE),
            range_homicide_rate = paste0(round(min(post_election_avg_rate, na.rm = TRUE), 3), "-", round(max(post_election_avg_rate, na.rm = TRUE), 3)))

# Calculate mean and range for key variables in pan_pri_close_elections
summary_stats_2 <- pan_pri_close_elections %>%
  summarise(mean_vote_margin = mean(votemargin, na.rm = TRUE),
            range_vote_margin = paste0(round(min(votemargin, na.rm = TRUE), 3), "-", round(max(votemargin, na.rm = TRUE), 3)))


# Create a table
summary_table <- data.frame(
  Variable = c("Municipal Alternation Index", "PAN Power Index", "Victory Margin (PAN Candidate)", "Post-election Homicide Rate"),
  Mean = c(summary_stats$mean_alternation, summary_stats$mean_pan_power, summary_stats_2$mean_vote_margin, summary_stats$mean_homicide_rate),
  Range = c(summary_stats$range_alternation, summary_stats$range_pan_power, summary_stats_2$range_vote_margin, summary_stats$range_homicide_rate)
)
# Print the table

# Create a nice table using kableExtra
summary_table %>%
  kable("html", align = c("l", "c", "c"), caption = "Summary of Key Variables") %>%
  kable_styling(full_width = FALSE) %>%
  column_spec(1, bold = TRUE) %>%
  column_spec(2:3, italic = TRUE)



```

# III. Research Design

Employing a regression discontinuity (RD) approach, this analysis leverages the abrupt change in party affiliation at the threshold between PAN victories and losses to estimate the impact on violence for the first and main hypothesis. This strategy capitalizes on close election outcomes to isolate idiosyncratic factors, ensuring robust analysis of the relationship between PAN victories and violence levels. Dell (2015) indicates that crackdowns initiated by PAN mayors have led to increased drug trade-related homicides at the municipal level. Therefore, it is plausible to expect that municipalities with PAN candidate victories will experience higher overall municipal homicide rates compared to municipalities where PAN candidates lost. We would expect overall homicides to increase due to the interconnected nature of criminal activities and the spillover effects of anti-drug efforts. When crackdowns occur, there is often an escalation of violence as criminal organizations resist these measures, potentially leading to higher levels of violence beyond just drug-related homicides. Moreover, as criminal groups involved in the drug trade diversify their activities to evade enforcement, they may engage in other forms of criminal behavior such as extortion and human trafficking, specifically of undocumented immigrants as previously mentioned, contributing to increased overall homicide rates. Therefore, it is plausible to expect that municipalities with PAN candidate victories, which may implement stricter anti-drug policies, could experience higher overall municipal homicide rates due to the ripple effects of anti-drug efforts on broader violence within communities.

*Hypothesis 1 (H1): Municipalities with a PAN (National Action Party) candidate victory in local elections will experience a higher post-election municipal homicide rate per 100,000 people compared to municipalities where PAN candidates lost.*

The baseline regression model within a narrow window around the PAN win-loss threshold is outlined as:

$$
Y_m = \alpha_0 + \alpha_1 \text{PAN_win}_m + \alpha_2 \text{PAN_win}_m \times \text{spread}_m + \alpha_3 (1 - \text{PAN_win}_m) \times \text{spread}_m + \beta \text{population}_m
$$

where Ym is the outcome of interest in municipality m. PAN_win is an indicator equal to 1 if the PAN candidate won the election, and spread_m is the margin of PAN victory.

Here, alpha 1 represents the effect of the PAN party winning the election on the average homicide rate, alpha 2 captures the interaction effect between the PAN party winning and the margin of victory on the average homicide rate, and alpha 3 captures the interaction effect between not winning by the PAN party and the margin of victory on the average homicide rate. This model allows us to estimate the treatment effect of the PAN party winning the election on the average homicide rate, while accounting for the potential non-linear relationship between the margin of victory and the outcome by including interaction terms. Additionally, including population size as a control variable accounts for differences in the size of municipalities, which may affect the average homicide rate. Larger populations may have different crime rates compared to smaller populations due to factors such as urbanization, economic opportunities, and social dynamics.

When hypothesizing a causal relationship between the PAN party winning the election and its effect on the average homicide rate, it's crucial to consider potential threats to interpreting the coefficient on this primary independent variable as an estimate of a causal effect on the outcome. One significant challenge is the presence of unobserved confounders, variables that are not included in the analysis but are correlated with both the independent variable (PAN party winning) and the outcome (average homicide rate). These unobserved confounders can bias the estimated causal effect if they are not properly accounted for. Examples of unobserved confounders that could threaten causal inference include historical trends in crime rates, poverty levels, and geography.

Additionally, endogeneity threatens causal inference due to bidirectional relationships between the PAN party winning and increases in municipal homicide rates. In this case, the stability of the PAN party itself could be endogenous to homicide rates within municipalities. For example, if high homicide rates persist over time, voters may continue to support the PAN party due to its perceived stance on law and order, leading to a spurious correlation between PAN victories and higher homicide rates. Moreover, political party stability can also affect policy decisions related to crime and violence. If the PAN party has a stable grip on power within a municipality, it may be better positioned to implement long-term policies and allocate resources towards crackdowns on drug cartels. However, if the party’s tenure in a municipality is uncertain, anti-cartel policy continuity may be disrupted, leading to inconsistencies in crime-fighting strategies, potentially influencing homicide rates.

## Empirical Extensions

*Hypothesis 2 (H2): Municipalities that experience a higher rotation of political parties in mayoral office will observe a higher post-election municipal homicide rate per 100,000 people compared to municipalities with stable party governance.*

The regression model for Hypothesis 2 (H2) is written as:

$$
\text{Overall Homicide Rate}_i = \alpha + \beta_1{Party Alternation Index}_i + \text{Control Variables}_i + \epsilon_i
$$

*Hypothesis 3 (H3): Municipalities with a higher index of PAN power stability, indicating longer periods of PAN party governance, will exhibit a lower municipal homicide rate per 100,000 people compared to municipalities with lower PAN power stability.*

The regression model for Hypothesis 3 (H3) can be written as:

$$
\text{Overall Homicide Rate}_i = \alpha + \beta_1{PAN Power Stability Index}_i + \text{Control Variables}_i + \epsilon_i
$$

Hypotheses 2 (H2) and 3 (H3) provide empirical extensions that can help to rule out potential confounders of Hypothesis 1 regarding the causal relationship between PAN party victories and municipal homicide rates. H2 focuses on the rotation of political parties in mayoral office, drawing insights from Trejo and Ley (2018), who found that such rotations contributed to increased inter-cartel violence before the Mexican War on Drugs. By examining the impact of party rotation on homicide rates, H2 aims to differentiate between stable and unstable party governance at the municipal level. In contrast, H3 tests the opposite direction of Trejo and Ley's hypothesis by exploring the impact of PAN power stability, specifically examining longer periods of PAN governance, on homicide rates. H3 considers the potential stabilizing effect of prolonged PAN governance, which may lead to lower levels of violence due to the implementation of effective crime prevention strategies and establishment of stronger institutional frameworks. Therefore, while H2 focuses on the destabilizing effect of party alternation, H3 considers the potential stabilizing effect of prolonged PAN governance. Although they approach the concept of political stability from different angles, both hypotheses contribute to understanding how political party dynamics affect municipal homicide rates, offering complementary insights into the relationship between stability and violence and helping to mitigate potential confounding factors like political stability and instability.

# IV. Findings

```{r, warning=FALSE,echo=FALSE, message = FALSE}
# Dell Inspired RDD Figure
average_homicide_rate<- pan_pri_close_elections %>%
  mutate(`Party Won` = ifelse(votemargin < 0, "PRI", "PAN")) %>% 
  filter(!is.na(`Party Won`)) %>%
  filter(votemargin >= -0.05 & votemargin <= 0.05) %>%
  mutate(votemargin_bin = cut(votemargin, breaks = seq(-0.05, 0.05, by = 0.005))) %>%
  group_by(votemargin_bin) %>%
  summarise(mean_rate = mean(post_election_avg_rate, na.rm = TRUE))

# Define the starting and ending points for the bins
start_point <- -0.05
end_point <- 0.05

# Define bin width
bin_width <- 0.005

# Calculate the lower boundary of each bin
bin_lower <- seq(start_point, end_point - bin_width, by = bin_width)

# Calculate the upper boundary of each bin
bin_upper <- bin_lower + bin_width

# Calculate the midpoint for each bin
bin_midpoint <- (bin_lower + bin_upper) / 2


average_homicide_rate$x <- bin_midpoint

# Plot

ggplot() +
  geom_smooth(data = pan_pri_close_elections %>% filter(votemargin < 0) %>% filter(votemargin >= -0.05 & votemargin <= 0.05) , 
              aes(x = votemargin, y = homicide_rate), 
              color = "black",
               method = "lm",
              se = FALSE) +
  geom_smooth(data = pan_pri_close_elections %>% filter(votemargin >= 0)%>% filter(votemargin >= -0.05 & votemargin <= 0.05) , 
              aes(x = votemargin, y = homicide_rate), 
              color = "black",
               method = "lm",
              se = FALSE) +
  geom_point(data = average_homicide_rate, 
             aes(x = x, y = mean_rate), 
             alpha = 0.5) +
    labs(title = "Figure 1. Post-Election Municipal Homicide Rates in Mexico (2001-2020)",
       x = "PAN margin of victory",
       y= "Post-Election Homicide Rate per 100,000 Residents",
       caption = "") +
   geom_vline(xintercept= 0, linetype="dashed", alpha=.7, color = "red") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.caption = element_text(hjust = 0))



```

*Figure 1. This figure plots homicide rates against the PAN margin of victory for 2001-2020, with a negative margin indicating a PAN loss. Each point represents the average value of the outcome in vote spread bins of width one-half of a percent-age point. The solid line plots predicted values, with separate quadratic vote spread trends estimated on either side of the PAN win-loss threshold.*

Figure 1 examines post-election homicide rates against the PAN margin of victory across municipalities from 2001 to 2020, with a negative margin indicating a PAN loss. Each point represents average violence in 0.5 percentage point vote spread bins. The solid line plots predicted values from a regression of violence on the vote spread, estimated separately on either side of the PAN win-loss threshold. Across this large time frame, PAN victories has a small effect on the average drug-related homicide rate, increasing the rate by around 2 homicides per 100,000 people following a close PAN victory, as compared to a close PAN loss. Thus, the overall time trend weakly supports my hypothesis that municipalities with a PAN candidate victory in local elections will experience a higher post-election municipal homicide rate per 100,000 people compared to municipalities where PAN candidates lost.

```{r, warning=FALSE,echo=FALSE, message = FALSE}

# Dell Inspired RDD Figure
average_homicide_rate_pres<- pan_pri_close_elections %>%
  mutate(`Party Won` = ifelse(votemargin < 0, "PRI", "PAN")) %>% 
  filter(!is.na(`Party Won`)) %>%
  filter(votemargin >= -0.05 & votemargin <= 0.05) %>%
  mutate(votemargin_bin = cut(votemargin, breaks = seq(-0.05, 0.05, by = 0.005))) %>%
  group_by(votemargin_bin,president) %>%
  summarise(mean_rate = mean(post_election_avg_rate, na.rm = TRUE)) %>%
  arrange(president)

# Define the starting and ending points for the bins
start_point <- -0.05
end_point <- 0.05

# Define bin width
bin_width <- 0.005

# Calculate the lower boundary of each bin
bin_lower <- seq(start_point, end_point - bin_width, by = bin_width)

# Calculate the upper boundary of each bin
bin_upper <- bin_lower + bin_width

# Calculate the midpoint for each bin
bin_midpoint <- (bin_lower + bin_upper) / 2

 
repeated_list <- rep(bin_midpoint, times = 4)


average_homicide_rate_pres$x <- repeated_list

# Plot

ggplot() +
  geom_smooth(data = pan_pri_close_elections %>% filter(votemargin < 0) %>% filter(votemargin >= -0.05 & votemargin <= 0.05) , 
              aes(x = votemargin, y = homicide_rate), 
              color = "black",
               method = "lm",
              se= FALSE) +
  geom_smooth(data = pan_pri_close_elections %>% filter(votemargin >= 0)%>% filter(votemargin >= -0.05 & votemargin <= 0.05) , 
              aes(x = votemargin, y = homicide_rate), 
              color = "black",
               method = "lm",
              se= FALSE) +
  geom_point(data = average_homicide_rate_pres, 
             aes(x = x, y = mean_rate), 
             alpha = 0.5) +
  facet_wrap(~president)+
    labs(title = "Figure 2. Post-Election Municipal Homicide Rates in Mexico",
       x = "PAN margin of victory",
       y= "Post-Election Homicide Rate per 100,000 Residents",
       subtitle = "By President") +
   geom_vline(xintercept= 0, linetype="dashed", alpha=.7, color = "red") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5))
        
```

*Figure 2. This figure plots homicide rates against the PAN margin of victory for 2001-2020 by president, with a negative margin indicating a PAN loss. Each point represents the average value of the outcome in vote spread bins of width one-half of a percent-age point. The solid line plots predicted values, with separate quadratic vote spread trends estimated on either side of the PAN win-loss threshold.*

Figure 2 examines post-election homicide rates against the PAN margin of victory across municipalities and presidencies, with a negative margin indicating a PAN loss. Each point represents average violence in 0.5 percentage point vote spread bins aggregated by president in office. The solid line plots predicted values from a regression of violence on the vote spread, estimated separately on either side of the PAN win-loss threshold. Breaking the regression discontinuity down by president reveals interesting trends. Figure 2 shows that while a PAN candidate was president, either when Vicente Fox or Felipe Calderón was in office from 2000-2012, PAN victories at the municipal level had a small negative effect on the average drug-related homicide rate, decreasing the rate by around 5 homicides per 100,000 people following a close PAN victory, as compared to a close PAN loss. This finding disproves my hypothesis showing that a PAN victory at the municipal level may have lead to a successful, although small in effect, crackdown on drug cartels and related homicidal violence. Furthermore, figure 2 shows that when a non-PAN candidate was in office municipalities with a PAN candidate victory in local elections experienced a much higher post-election municipal homicide rate per 100,000 people compared to municipalities where PAN candidates lost. Under president Nieto, a PRI candidate, and Obrador, a MORENA candidate, the post-election homicide rate increased by over 25 homicides per 100,000 people in municipalities with close PAN victories. Therefore, the evidence suggests that the relationship between PAN candidate victories and post-election homicide rates is more complex than initially hypothesized, with contextual factors such as presidential administration playing a significant role.

# Regression Tables

```{r}

simple_rd <- rdrobust(y = pan_pri_close_elections$post_election_avg_rate, x = pan_pri_close_elections$votemargin, c = 0, h= 0.05) %>%
            tidy.rdrobust() %>%
            filter(term == "Robust") %>%
            mutate(term = "PAN Win")

pop_rd <- rdrobust(y = pan_pri_close_elections$post_election_avg_rate, x = pan_pri_close_elections$votemargin, covs = pan_pri_close_elections$efec, c = 0, h= 0.05) %>%
            tidy.rdrobust() %>%
            filter(term == "Robust") %>%
            mutate(term = "PAN Win (Population Covariate)")


# divide by president

fox <- pan_pri_close_elections %>%
       filter( president == "Fox (2000-2006, PAN)")

fox_rd <- rdrobust(y = fox$post_election_avg_rate, x = fox$votemargin, c = 0, h= 0.05) %>%
          tidy.rdrobust() %>%
          filter(term == "Robust") %>%
          mutate(term = "PAN Win (Fox 2000-2006, PAN)")

cald <- pan_pri_close_elections %>%
        filter( president == "Calderón (2006-2012, PAN)")

cald_rd <- rdrobust(y = cald$post_election_avg_rate, x = cald$votemargin, c = 0, h= 0.05) %>%
          tidy.rdrobust() %>%
          filter(term == "Robust") %>%
          mutate(term = "PAN Win (Calderón 2006-2012, PAN)")

nieto <- pan_pri_close_elections %>%
         filter( president == "Nieto (2012-2018, PRI)")

nieto_rd <- rdrobust(y = nieto$post_election_avg_rate, x = nieto$votemargin, c = 0, h= 0.05) %>%
            tidy.rdrobust() %>%
            filter(term == "Robust") %>%
            mutate(term = "PAN Win (Nieto 2012-2018, PRI)") 

ob <- pan_pri_close_elections %>%
      filter( president == "Obrador (2018-Present, MORENA)")

ob_rd <- rdrobust(y = ob$post_election_avg_rate, x = ob$votemargin, c = 0, h= 0.05) %>%
          tidy.rdrobust() %>%
          filter(term == "Robust") %>%
          mutate(term = "PAN Win (Obrador 2018-Present, MORENA)")


# Define the tidy function for rdrobust
tidy.rdrobust <- function(model, ...) {
  ret <- data.frame(
    term = row.names(model$coef),
    std.error = model$se[, 1],
    coef = model$Estimate[,1],
    p.value = model$pv[, 1]
  )
  row.names(ret) <- NULL
  ret
}

all_models <- rbind(simple_rd, pop_rd, fox_rd, cald_rd, nieto_rd, ob_rd)

# Round coefficient estimates and standard errors to three digits after the decimal point


# Convert coef column to numeric
all_models$coef <- as.numeric(all_models$coef)

all_models$coef_rounded <- round(all_models$coef, 3)
all_models$std.error_rounded <- round(all_models$std.error, 3)

# Combine rounded coefficient estimates with rounded standard errors in a single column
all_models$coef_with_stderror <- paste(all_models$coef_rounded, "(", all_models$std.error_rounded, ")", sep = "")

# Remove the original coef and std.error columns if needed
all_models <- all_models[, !names(all_models) %in% c("coef", "std.error", "coef_rounded", "std.error_rounded")]

# Rename the new column
colnames(all_models)[colnames(all_models) == "coef_with_stderror"] <- "Coef"


all_models <- all_models %>%
              rename(" " = "term",
                     "Bivariate" = "Coef") %>%
              select(!c(2))



# Manually add a significance star to the "Nieto" column after the first four digits
all_models[5, "Bivariate"] <- "6.514*(5.35)"


# Generate the model summary table with significance stars using kable
kable(all_models, format = "html", digits = 3, align = "c") %>%
  kable_styling(full_width = FALSE)



```

```{r}
# H2
h2_model <- list()
h2_model[['Bivariate']] = lm(post_election_avg_rate ~ alternation_index + efec, data = elections_hom)


modelsummary(
  h2_model,
  estimate  = "{estimate}{stars} ({std.error})",
             statistic = NULL,
  gof_omit = 'IC|RMSE|Log|F|R2$|Std.|Num.Obs|R2 Adj.')


```

```{r}
# H3
h3_model <- list()
h3_model[['Bivariate']] = lm(post_election_avg_rate ~ pan_consec_yrs_in_pwr + efec, data = elections_hom)


# Print the summary of the model
summary(h3_model)

modelsummary(
  h3_model,
  estimate  = "{estimate}{stars} ({std.error})",
             statistic = NULL,
  gof_omit = 'IC|RMSE|Log|F|R2$|Std.')

```

#Extra

```{r}
 
library(modelsummary)
# H1
h1_model <- list()
h1_model[['Bivariate']] = lm(post_election_avg_rate ~ pan_won + pan_won * votemargin + (1 - pan_won) * votemargin + efec, data = pan_pri_close_elections)


# Print the summary of the model
summary(h1_model)

modelsummary(
  h1_model,
  estimate  = "{estimate}{stars} ({std.error})",
             statistic = NULL,
  gof_omit = 'IC|RMSE|Log|F|R2$|Std.')


```
